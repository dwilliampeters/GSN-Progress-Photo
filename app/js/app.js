function empty(t){var e,i,o,n,a=[e,null,!1,0,"","0"];for(o=0,n=a.length;n>o;o++)if(t===a[o])return!0;if("object"==typeof t){for(i in t)return!1;return!0}return!1}!function(t,e){"use strict";e.html5imageupload=function(i,o){this.element=o,this.options=e.extend(!0,{},e.html5imageupload.defaults,i,e(this.element).data()),this.input=e(this.element).find("input[type=file]");var n=(e(t),this);this.interval=null,this.drag=!1,this.widthPercentage=100,this.button={},this.button.edit='<div class="btn btn-info btn-edit"><i class="glyphicon glyphicon-pencil"></i></div>',this.button.saving='<div class="btn btn-warning saving">'+(this.options.saveLabel||"Saving...")+' <i class="glyphicon glyphicon-time"></i></div>',this.button.zoomin='<div class="btn btn-default btn-zoom-in"><i class="glyphicon glyphicon-resize-full"></i></div>',this.button.zoomout='<div class="btn btn-default btn-zoom-out"><i class="glyphicon glyphicon-resize-small"></i></div>',this.button.zoomreset='<div class="btn btn-default btn-zoom-reset"><i class="glyphicon glyphicon-fullscreen"></i></div>',this.button.cancel='<div class="btn btn-danger btn-cancel"><i class="glyphicon glyphicon-remove"></i></div>',this.button.done='<div class="btn btn-success btn-ok"><i class="glyphicon glyphicon-ok"></i></div>',this.button.del='<div class="btn btn-danger btn-del"><i class="glyphicon glyphicon-trash"></i></div>',this.imageMimes={png:"image/png",bmp:"image/bmp",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",tiff:"image/tiff"},n._init()},e.html5imageupload.defaults={width:null,height:null,image:null,ghost:!0,originalsize:!0,url:!1,removeurl:null,data:{},canvas:!0,ajax:!0,resize:!1,dimensionsonly:!1,editstart:!1,saveOriginal:!1,onAfterZoomImage:null,onAfterInitImage:null,onAfterMoveImage:null,onAfterProcessImage:null,onAfterResetImage:null,onAfterCancel:null,onAfterRemoveImage:null,onAfterSelectImage:null},e.html5imageupload.prototype={_init:function(){var i=this,o=i.options,n=i.element,a=i.input;if(empty(e(n)))return!1;if(e(n).children().css({position:"absolute"}),!(t.FormData&&"upload"in e.ajaxSettings.xhr()))return e(n).empty().attr("class","").addClass("alert alert-danger").html("HTML5 Upload Image: Sadly.. this browser does not support the plugin, update your browser today!"),!1;if(!empty(o.width)&&empty(o.height)&&e(n).innerHeight()<=0)return e(n).empty().attr("class","").addClass("alert alert-danger").html("HTML5 Upload Image: Image height is not set and can not be calculated..."),!1;if(!empty(o.height)&&empty(o.width)&&e(n).innerWidth()<=0)return e(n).empty().attr("class","").addClass("alert alert-danger").html("HTML5 Upload Image: Image width is not set and can not be calculated..."),!1;if(!empty(o.height)&&!empty(o.width)&&!empty(e(n).innerHeight()&&!empty(e(n).innerWidth()))&&o.width/o.height!=e(n).outerWidth()/e(n).outerHeight())return e(n).empty().attr("class","").addClass("alert alert-danger").html("HTML5 Upload Image: The ratio of all sizes (CSS and image) are not the same..."),!1;var r,s,h,l;if(o.width=h=o.width||e(n).outerWidth(),o.height=l=o.height||e(n).outerHeight(),e(n).innerWidth()>0?r=e(n).outerWidth():e(n).innerHeight()>0?r=null:empty(o.width)||(r=o.width),e(n).innerHeight()>0?s=e(n).outerHeight():e(n).innerWidth()>0?s=null:empty(o.height)||(s=o.height),s=s||r/(h/l),r=r||s/(l/h),240>r&&e(n).addClass("smalltools smalltext"),e(n).css({height:s,width:r}),i.widthPercentage=e(n).outerWidth()/e(n).offsetParent().width()*100,1==o.resize&&e(t).resize(function(){i.resize()}),i._bind(),(o.required||e(a).prop("required"))&&(i.options.required=!0,e(a).prop("required",!0)),o.ajax||i._formValidation(),empty(o.image)||0!=o.editstart)empty(o.image)||i.readImage(o.image,o.image,o.image,i.imageMimes[o.image.split(".").pop()]);else{e(n).data("name",o.image).append(e("<img />").addClass("preview").attr("src",o.image));var d=e('<div class="preview tools"></div>'),p=e(""+this.button.del);e(p).click(function(t){t.preventDefault(),i.reset()}),0!=o.buttonDel&&e(d).append(p),e(n).append(d)}i.options.onAfterInitImage&&i.options.onAfterInitImage.call(i)},_bind:function(){var t=this,i=t.element,o=t.input;e(i).unbind("dragover").unbind("drop").unbind("mouseout").on({dragover:function(e){t.handleDrag(e)},drop:function(i){t.handleFile(i,e(this))},mouseout:function(){t.imageUnhandle()}}),e(o).unbind("change").change(function(o){t.drag=!1,t.handleFile(o,e(i))})},handleFile:function(t,i){t.stopPropagation(),t.preventDefault();var o=this,n=this.options,a=0==o.drag?t.originalEvent.target.files:t.originalEvent.dataTransfer.files;o.drag=!1,null==n.removeurl||empty(e(i).data("name"))||e.ajax({type:"POST",url:n.removeurl,data:{image:e(i).data("name")},success:function(t){o.options.onAfterRemoveImage&&o.options.onAfterRemoveImage.call(o,t)}}),e(i).removeClass("notAnImage").addClass("loading");for(var r,s=0;r=a[s];s++)if(r.type.match("image.*")){var h=new FileReader;h.onload=function(t){return function(n){e(i).find("img").remove(),o.readImage(h.result,n.target.result,t.name,t.type)}}(r),h.readAsDataURL(r)}else e(i).addClass("notAnImage");o.options.onAfterSelectImage&&o.options.onAfterSelectImage.call(o,response)},readImage:function(t,i,o,n){var a=this,r=this.options,s=this.element;a.drag=!1;var h=new Image;h.onload=function(){var t,l,d,p,m,g,u=e('<img src="'+i+'" name="'+o+'" />');t=d=h.width,l=p=h.height,m=t/l,g=e(s).outerWidth()/e(s).outerHeight(),0==r.originalsize?(d=e(s).outerWidth()+40,p=d/m,p<e(s).outerHeight()&&(p=e(s).outerHeight()+40,d=p*m)):(d<e(s).outerWidth()||p<e(s).outerHeight())&&(g>m?(d=e(s).outerWidth(),p=d/m):(p=e(s).outerHeight(),d=p*m));var c=parseFloat((e(s).outerWidth()-d)/2),f=parseFloat((e(s).outerHeight()-p)/2);u.css({left:c,top:f,width:d,height:p}),a.image=e(u).clone().data({mime:n,width:t,height:l,ratio:m,left:c,top:f,useWidth:d,useHeight:p}).addClass("main").bind("mousedown touchstart",function(t){a.imageHandle(t)}),a.imageGhost=r.ghost?e(u).addClass("ghost"):null,e(s).append(e('<div class="cropWrapper"></div>').append(e(a.image))),empty(a.imageGhost)||e(s).append(a.imageGhost),a._tools(),e(s).removeClass("loading")},h.src=t},handleDrag:function(t){var e=this;e.drag=!0,t.stopPropagation(),t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy"},imageHandle:function(t){t.preventDefault();var i=t.originalEvent.touches||t.originalEvent.changedTouches?t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]:t,o=this,n=this.element,a=this.image,r=a.outerHeight(),s=a.outerWidth(),h=a.offset().top+r-i.pageY,l=a.offset().left+s-i.pageX;a.on({"mousemove touchmove":function(t){t.stopImmediatePropagation(),t.preventDefault();var i=t.originalEvent.touches||t.originalEvent.changedTouches?t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]:t,d=i.pageY+h-r,p=i.pageX+l-s,m=e(n).outerWidth()!=e(n).innerWidth();parseInt(d-e(n).offset().top)>0?d=e(n).offset().top+(m?1:0):d+r<e(n).offset().top+e(n).outerHeight()&&(d=e(n).offset().top+e(n).outerHeight()-r+(m?1:0)),parseInt(p-e(n).offset().left)>0?p=e(n).offset().left+(m?1:0):p+s<e(n).offset().left+e(n).outerWidth()&&(p=e(n).offset().left+e(n).outerWidth()-s+(m?1:0)),a.offset({top:d,left:p}),o._ghost()},"mouseup touchend":function(){o.imageUnhandle()}})},imageUnhandle:function(){var t=this,i=t.image;e(i).unbind("mousemove touchmove"),t.options.onAfterMoveImage&&t.options.onAfterMoveImage.call(t)},imageZoom:function(t){var i=this,o=i.element,n=i.image;if(empty(n))return i._clearTimers(),!1;var a=n.data("ratio"),r=n.outerWidth()+t,s=r/a;r<e(o).outerWidth()&&(r=e(o).outerWidth(),s=r/a,t=e(n).outerWidth()-r),s<e(o).outerHeight()&&(s=e(o).outerHeight(),r=s*a,t=e(n).outerWidth()-r);var h=Math.round(parseFloat(n.css("top"))-parseFloat(s-n.outerHeight())/2),l=parseInt(n.css("left"))-t/2;e(o).offset().left-l<e(o).offset().left?l=0:e(o).outerWidth()>l+e(n).outerWidth()&&0>=t&&(l=e(o).outerWidth()-r),e(o).offset().top-h<e(o).offset().top?h=0:e(o).outerHeight()>h+e(n).outerHeight()&&0>=t&&(h=e(o).outerHeight()-s),n.css({width:r,height:s,top:h,left:l}),i._ghost()},imageCrop:function(){var t,i,o,n,a,r,s,h,l=this,d=l.element,p=l.image,m=l.input,g=l.options,u=g.width!=e(d).outerWidth()?g.width/e(d).outerWidth():1;t=g.width,i=g.height,o=-1*parseInt(Math.round(parseInt(e(p).css("top"))*u)),n=-1*parseInt(Math.round(parseInt(e(p).css("left"))*u)),a=parseInt(Math.round(e(p).width()*u)),r=parseInt(Math.round(e(p).height()*u)),s=e(p).data("width"),h=e(p).data("height"),o=o||0,n=n||0;var c={name:e(p).attr("name"),imageOriginalWidth:s,imageOriginalHeight:h,imageWidth:a,imageHeight:r,width:t,height:i,left:n,top:o};if(e(d).find(".tools").children().toggle(),e(d).find(".tools").append(e(l.button.saving)),1==g.canvas){var f=e('<canvas class="final" id="canvas_'+e(m).attr("name")+'" width="'+t+'" height="'+i+'" style="position:absolute; top: 0; bottom: 0; left: 0; right: 0; z-index:100; width: 100%; height: 100%;"></canvas>');e(d).append(f);var v=e(f)[0].getContext("2d"),w=new Image;w.onload=function(){{var s=e('<canvas width="'+a+'" height="'+r+'"></canvas>'),h=e(s)[0].getContext("2d");e('<img src="" />')}h.drawImage(w,0,0,a,r);var u=new Image;u.onload=function(){if(v.drawImage(u,n,o,t,i,0,0,t,i),1==g.ajax)l._ajax(e.extend({data:e(f)[0].toDataURL(p.data("mime"))},c));else{var a=JSON.stringify(e.extend({data:e(f)[0].toDataURL(p.data("mime"))},c));e(m).after(e('<input type="text" name="'+e(m).attr("name")+'_values" class="final" />').val(a)),e(m).data("required",e(m).prop("required")),e(m).prop("required",!1),e(m).wrap("<form>").parent("form").trigger("reset"),e(m).unwrap(),e(d).find(".tools .saving").remove(),e(d).find(".tools").children().toggle(),l.imageFinal()}},u.src=e(s)[0].toDataURL(p.data("mime"))},w.src=e(p).attr("src"),g.saveOriginal===!0&&(c=e.extend({original:e(p).attr("src")},c))}else if(1==g.ajax)l._ajax(e.extend({data:e(p).attr("src"),saveOriginal:g.saveOriginal},c));else{var y=e(d).find(".cropWrapper").clone();e(y).addClass("final").show().unbind().children().unbind(),e(d).append(e(y)),l.imageFinal();var b=JSON.stringify(c);e(m).after(e('<input type="text" name="'+e(m).attr("name")+'_values" class="final" />').val(b))}},_ajax:function(t){var i=this,o=i.element,n=(i.image,i.options);1==n.dimensionsonly&&delete t.data,e.ajax({type:"POST",url:n.url,data:e.extend(t,n.data),success:function(t){if("success"==t.status){var a=t.url.split("?");e(o).find(".tools .saving").remove(),e(o).find(".tools").children().toggle(),e(o).data("name",a[0]),1!=n.canvas&&e(o).append(e('<img src="'+a[0]+'" class="final" style="width: 100%" />')),i.imageFinal()}else e(o).find(".tools .saving").remove(),e(o).find(".tools").children().toggle(),e(o).append(e('<div class="alert alert-danger">'+t.error+"</div>").css({bottom:"10px",left:"10px",right:"10px",position:"absolute",zIndex:99})),setTimeout(function(){i.responseReset()},2e3)},error:function(t){e(o).find(".tools .saving").remove(),e(o).find(".tools").children().toggle(),e(o).append(e('<div class="alert alert-danger"><strong>'+t.status+"</strong> "+t.statusText+"</div>").css({bottom:"10px",left:"10px",right:"10px",position:"absolute",zIndex:99})),setTimeout(function(){i.responseReset()},2e3)}})},imageReset:function(){{var t=this,i=t.image;t.element}e(i).css({width:i.data("useWidth"),height:i.data("useHeight"),top:i.data("top"),left:i.data("left")}),t._ghost(),t.options.onAfterResetImage&&t.options.onAfterResetImage.call(t)},imageFinal:function(){var t=this,i=t.element,o=t.input,n=t.options;e(i).addClass("done"),e(i).children().not(".final").hide();var a=e('<div class="tools final">');0!=n.buttonEdit&&e(a).append(e(t.button.edit).click(function(){e(i).children().show(),e(i).find(".final").remove(),e(o).data("valid",!1)})),0!=n.buttonDel&&e(a).append(e(t.button.del).click(function(){t.reset()})),e(i).append(a),e(i).unbind(),e(o).unbind().data("valid",!0),t.options.onAfterProcessImage&&t.options.onAfterProcessImage.call(t)},responseReset:function(){var t=this,i=t.element;e(i).find(".alert").remove()},reset:function(){var t=this,i=t.element,o=t.input,n=t.options;t.image=null,e(i).find(".preview").remove(),e(i).removeClass("loading done").children().show().not("input[type=file]").remove(),e(o).wrap("<form>").parent("form").trigger("reset"),e(o).unwrap(),e(o).prop("required",e(o).data("required")||n.required||!1).data("valid",!1),t._bind(),null==n.removeurl||empty(e(i).data("name"))||e.ajax({type:"POST",url:n.removeurl,data:{image:e(i).data("name")},success:function(e){t.options.onAfterRemoveImage&&t.options.onAfterRemoveImage.call(t,e)}}),e(i).data("name",null),t.imageGhost&&(e(t.imageGhost).remove(),t.imageGhost=null),t.options.onAfterCancel&&t.options.onAfterCancel.call(t)},resize:function(){var t=this,i=t.options,o=t.element,n=t.image;if(i.resize!==!0)return!1;var a=e(o).outerWidth(),r=e(o).offsetParent().width()*(t.widthPercentage/100),s=r/a,h=e(o).outerHeight()*s;e(o).css({height:h,width:r}),240>r?e(o).hasClass("smalltools smalltext")||e(o).addClass("smalltools smalltext smalladded"):e(o).hasClass("smalladded")&&e(o).removeClass("smalltools smalltext smalladded"),empty(n)||(e(n).css({left:e(n).css("left").replace(/[^-\d\.]/g,"")*s+"px",top:e(n).css("top").replace(/[^-\d\.]/g,"")*s+"px"}),e(n).width(e(n).width()*s),e(n).height(e(n).height()*s),t._ghost())},_ghost:function(){var t=this,i=t.options,o=t.image,n=t.imageGhost;1!=i.ghost||empty(n)||e(n).css({width:o.css("width"),height:o.css("height"),top:o.css("top"),left:o.css("left")})},_tools:function(){var i=this,o=i.element,n=e('<div class="tools"></div>'),a=i.options;0!=a.buttonZoomin&&e(n).append(e(i.button.zoomin).on({"touchstart mousedown":function(e){e.preventDefault(),i.interval=t.setInterval(function(){i.imageZoom(2)},1)},"touchend mouseup mouseleave":function(e){e.preventDefault(),t.clearInterval(i.interval),i.options.onAfterZoomImage&&i.options.onAfterZoomImage.call(i)}})),0!=a.buttonZoomreset&&e(n).append(e(i.button.zoomreset).on({"touchstart click":function(t){t.preventDefault(),i.imageReset()}})),0!=a.buttonZoomout&&e(n).append(e(i.button.zoomout).on({"touchstart mousedown":function(e){e.preventDefault(),i.interval=t.setInterval(function(){i.imageZoom(-2)},1)},"touchend mouseup mouseleave":function(e){e.preventDefault(),t.clearInterval(i.interval),i.options.onAfterZoomImage&&i.options.onAfterZoomImage.call(i)}})),0!=a.buttonCancel&&e(n).append(e(i.button.cancel).on({"touchstart touchend click":function(t){t.preventDefault(),i.reset()}})),0!=a.buttonDone&&e(n).append(e(i.button.done).on({"touchstart click":function(t){t.preventDefault(),i.imageCrop()}})),e(o).append(e(n))},_clearTimers:function(){for(var e=t.setInterval("",9999),i=1;e>i;i++)t.clearInterval(i)},_formValidation:function(){{var t=this,i=t.element;t.input}e(i).closest("form").submit(function(t){return e(this).find("input[type=file]").each(function(i,o){return e(o).prop("required")&&e(o).data("valid")!==!0?(t.preventDefault(),!1):void 0}),!0})}},e.fn.html5imageupload=function(t){return e.data(this,"html5imageupload")?void 0:e(this).each(function(){new e.html5imageupload(t,this),e.data(this,"html5imageupload")})}}(window,jQuery),function(t){var e;e=function(){function t(){}return t.prototype.setup=function(t,e,i,o){var n,a;return null==i&&(i=1),a=e.w/t.w,n=e.h/t.h,this.minZoom=(null!=o?o.fitWidth:void 0)&&!(null!=o?o.fitHeight:void 0)?a:(null!=o?o.fitHeight:void 0)&&!(null!=o?o.fitWidth:void 0)?n:(null!=o?o.fitWidth:void 0)&&(null!=o?o.fitHeight:void 0)?n>a?a:n:n>a?n:a,this.maxZoom=this.minZoom<1/i?1/i:this.minZoom},t.prototype.getZoom=function(t){return this.minZoom&&this.maxZoom?t*(this.maxZoom-this.minZoom)+this.minZoom:null},t.prototype.getSliderPos=function(t){return this.minZoom&&this.maxZoom?this.minZoom===this.maxZoom?0:(t-this.minZoom)/(this.maxZoom-this.minZoom):null},t.prototype.isZoomable=function(){return this.minZoom&&this.maxZoom?this.minZoom!==this.maxZoom:null},t.prototype.fixZoom=function(t){return t<this.minZoom?this.minZoom:t>this.maxZoom?this.maxZoom:t},t}();var i;i=function(){function i(e,o){var n;this.element=e,this.$el=t(this.element),n={$fileInput:this.$("input.cropit-image-input"),$preview:this.$(".cropit-image-preview"),$zoomSlider:this.$("input.cropit-image-zoom-input"),$previewContainer:this.$(".cropit-image-preview-container")},this.options=t.extend({},i._DEFAULTS,n,o),this.init()}return i._DEFAULTS={exportZoom:1,imageBackground:!1,imageBackgroundBorderWidth:0,imageState:null,allowCrossOrigin:!1,allowDragNDrop:!0,fitWidth:!1,fitHeight:!1,freeMove:!1},i.PREVIEW_EVENTS=function(){return["mousedown","mouseup","mouseleave","touchstart","touchend","touchcancel","touchleave"].map(function(t){return""+t+".cropit"}).join(" ")}(),i.PREVIEW_MOVE_EVENTS="mousemove.cropit touchmove.cropit",i.ZOOM_INPUT_EVENTS=function(){return["mousemove","touchmove","change"].map(function(t){return""+t+".cropit"}).join(" ")}(),i.prototype.init=function(){var i,o,n,a;return this.image=new Image,this.options.allowCrossOrigin&&(this.image.crossOrigin="Anonymous"),this.$fileInput=this.options.$fileInput.attr({accept:"image/*"}),this.$preview=this.options.$preview.css({backgroundRepeat:"no-repeat"}),this.$zoomSlider=this.options.$zoomSlider.attr({min:0,max:1,step:.01}),this.previewSize={w:this.options.width||this.$preview.width(),h:this.options.height||this.$preview.height()},this.options.width&&this.$preview.width(this.previewSize.w),this.options.height&&this.$preview.height(this.previewSize.h),this.options.imageBackground&&(t.isArray(this.options.imageBackgroundBorderWidth)?this.imageBgBorderWidthArray=this.options.imageBackgroundBorderWidth:(this.imageBgBorderWidthArray=[],[0,1,2,3].forEach(function(t){return function(e){return t.imageBgBorderWidthArray[e]=t.options.imageBackgroundBorderWidth}}(this))),i=this.options.$previewContainer,this.$imageBg=t("<img />").addClass("cropit-image-background").attr("alt","").css("position","absolute"),this.$imageBgContainer=t("<div />").addClass("cropit-image-background-container").css({position:"absolute",zIndex:0,left:-this.imageBgBorderWidthArray[3]+window.parseInt(this.$preview.css("border-left-width")),top:-this.imageBgBorderWidthArray[0]+window.parseInt(this.$preview.css("border-top-width")),width:this.previewSize.w+this.imageBgBorderWidthArray[1]+this.imageBgBorderWidthArray[3],height:this.previewSize.h+this.imageBgBorderWidthArray[0]+this.imageBgBorderWidthArray[2]}).append(this.$imageBg),this.imageBgBorderWidthArray[0]>0&&this.$imageBgContainer.css({overflow:"hidden"}),i.css("position","relative").prepend(this.$imageBgContainer),this.$preview.css("position","relative"),this.$preview.hover(function(t){return function(){return t.$imageBg.addClass("cropit-preview-hovered")}}(this),function(t){return function(){return t.$imageBg.removeClass("cropit-preview-hovered")}}(this))),this.initialOffset={x:0,y:0},this.initialZoom=0,this.initialZoomSliderPos=0,this.imageLoaded=!1,this.moveContinue=!1,this.zoomer=new e,this.options.allowDragNDrop&&jQuery.event.props.push("dataTransfer"),this.bindListeners(),this.$zoomSlider.val(this.initialZoomSliderPos),this.setOffset((null!=(o=this.options.imageState)?o.offset:void 0)||this.initialOffset),this.zoom=(null!=(n=this.options.imageState)?n.zoom:void 0)||this.initialZoom,this.loadImage((null!=(a=this.options.imageState)?a.src:void 0)||null)},i.prototype.bindListeners=function(){return this.$fileInput.on("change.cropit",this.onFileChange.bind(this)),this.$preview.on(i.PREVIEW_EVENTS,this.onPreviewEvent.bind(this)),this.$zoomSlider.on(i.ZOOM_INPUT_EVENTS,this.onZoomSliderChange.bind(this)),this.options.allowDragNDrop?(this.$preview.on("dragover.cropit dragleave.cropit",this.onDragOver.bind(this)),this.$preview.on("drop.cropit",this.onDrop.bind(this))):void 0},i.prototype.unbindListeners=function(){return this.$fileInput.off("change.cropit"),this.$preview.off(i.PREVIEW_EVENTS),this.$preview.off("dragover.cropit dragleave.cropit drop.cropit"),this.$zoomSlider.off(i.ZOOM_INPUT_EVENTS)},i.prototype.reset=function(){return this.zoom=this.initialZoom,this.offset=this.initialOffset},i.prototype.onFileChange=function(){var t;return"function"==typeof(t=this.options).onFileChange&&t.onFileChange(),this.loadFileReader(this.$fileInput.get(0).files[0])},i.prototype.loadFileReader=function(t){var e;return e=new FileReader,(null!=t?t.type.match("image"):void 0)?(this.setImageLoadingClass(),e.readAsDataURL(t),e.onload=this.onFileReaderLoaded.bind(this),e.onerror=this.onFileReaderError.bind(this)):void 0},i.prototype.onFileReaderLoaded=function(t){return this.reset(),this.loadImage(t.target.result)},i.prototype.onFileReaderError=function(){var t;return"function"==typeof(t=this.options).onFileReaderError?t.onFileReaderError():void 0},i.prototype.onDragOver=function(t){return t.preventDefault(),t.dataTransfer.dropEffect="copy",this.$preview.toggleClass("cropit-drag-hovered","dragover"===t.type)},i.prototype.onDrop=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=Array.prototype.slice.call(t.dataTransfer.files,0),e.some(function(t){return function(e){return e.type.match("image")?(t.loadFileReader(e),!0):void 0}}(this)),this.$preview.removeClass("cropit-drag-hovered")},i.prototype.loadImage=function(t){var e;return this.imageSrc=t,this.imageSrc?("function"==typeof(e=this.options).onImageLoading&&e.onImageLoading(),this.setImageLoadingClass(),this.image.onload=this.onImageLoaded.bind(this),this.image.onerror=this.onImageError.bind(this),this.image.src=this.imageSrc):void 0},i.prototype.onImageLoaded=function(){var t;return this.setImageLoadedClass(),this.setOffset(this.offset),this.$preview.css("background-image","url("+this.imageSrc+")"),this.options.imageBackground&&this.$imageBg.attr("src",this.imageSrc),this.imageSize={w:this.image.width,h:this.image.height},this.setupZoomer(),this.imageLoaded=!0,"function"==typeof(t=this.options).onImageLoaded?t.onImageLoaded():void 0},i.prototype.onImageError=function(){var t;return"function"==typeof(t=this.options).onImageError?t.onImageError():void 0},i.prototype.setImageLoadingClass=function(){return this.$preview.removeClass("cropit-image-loaded").addClass("cropit-image-loading")},i.prototype.setImageLoadedClass=function(){return this.$preview.removeClass("cropit-image-loading").addClass("cropit-image-loaded")},i.prototype.getEventPosition=function(t){var e,i,o,n;return(null!=(e=t.originalEvent)&&null!=(i=e.touches)?i[0]:void 0)&&(t=null!=(o=t.originalEvent)&&null!=(n=o.touches)?n[0]:void 0),t.clientX&&t.clientY?{x:t.clientX,y:t.clientY}:void 0},i.prototype.onPreviewEvent=function(e){return this.imageLoaded?(this.moveContinue=!1,this.$preview.off(i.PREVIEW_MOVE_EVENTS),"mousedown"===e.type||"touchstart"===e.type?(this.origin=this.getEventPosition(e),this.moveContinue=!0,this.$preview.on(i.PREVIEW_MOVE_EVENTS,this.onMove.bind(this))):t(document.body).focus(),e.stopPropagation(),!1):void 0},i.prototype.onMove=function(t){var e;return e=this.getEventPosition(t),this.moveContinue&&e&&this.setOffset({x:this.offset.x+e.x-this.origin.x,y:this.offset.y+e.y-this.origin.y}),this.origin=e,t.stopPropagation(),!1},i.prototype.setOffset=function(t){return this.offset=this.fixOffset(t),this.$preview.css("background-position",""+this.offset.x+"px "+this.offset.y+"px"),this.options.imageBackground?this.$imageBg.css({left:this.offset.x+this.imageBgBorderWidthArray[3],top:this.offset.y+this.imageBgBorderWidthArray[0]}):void 0},i.prototype.fixOffset=function(t){var e;return this.imageLoaded?(e={x:t.x,y:t.y},this.options.freeMove||(this.imageSize.w*this.zoom<=this.previewSize.w?e.x=0:e.x>0?e.x=0:e.x+this.imageSize.w*this.zoom<this.previewSize.w&&(e.x=this.previewSize.w-this.imageSize.w*this.zoom),this.imageSize.h*this.zoom<=this.previewSize.h?e.y=0:e.y>0?e.y=0:e.y+this.imageSize.h*this.zoom<this.previewSize.h&&(e.y=this.previewSize.h-this.imageSize.h*this.zoom)),e.x=this.round(e.x),e.y=this.round(e.y),e):t},i.prototype.onZoomSliderChange=function(){var t;if(this.imageLoaded)return this.zoomSliderPos=Number(this.$zoomSlider.val()),t=this.zoomer.getZoom(this.zoomSliderPos),this.setZoom(t)},i.prototype.enableZoomSlider=function(){var t;return this.$zoomSlider.removeAttr("disabled"),"function"==typeof(t=this.options).onZoomEnabled?t.onZoomEnabled():void 0},i.prototype.disableZoomSlider=function(){var t;return this.$zoomSlider.attr("disabled",!0),"function"==typeof(t=this.options).onZoomDisabled?t.onZoomDisabled():void 0},i.prototype.setupZoomer=function(){return this.zoomer.setup(this.imageSize,this.previewSize,this.options.exportZoom,this.options),this.zoom=this.fixZoom(this.zoom),this.setZoom(this.zoom),this.isZoomable()?this.enableZoomSlider():this.disableZoomSlider()},i.prototype.setZoom=function(t){var e,i,o,n,a;return t=this.fixZoom(t),a=this.round(this.imageSize.w*t),n=this.round(this.imageSize.h*t),o=this.zoom,e=this.previewSize.w/2-(this.previewSize.w/2-this.offset.x)*t/o,i=this.previewSize.h/2-(this.previewSize.h/2-this.offset.y)*t/o,this.zoom=t,this.setOffset({x:e,y:i}),this.zoomSliderPos=this.zoomer.getSliderPos(this.zoom),this.$zoomSlider.val(this.zoomSliderPos),this.$preview.css("background-size",""+a+"px "+n+"px"),this.options.imageBackground?this.$imageBg.css({width:a,height:n}):void 0},i.prototype.fixZoom=function(t){return this.zoomer.fixZoom(t)},i.prototype.isZoomable=function(){return this.zoomer.isZoomable()},i.prototype.getCroppedImageData=function(e){var i,o,n,a,r;return this.imageSrc?(a={type:"image/png",quality:.75,originalSize:!1,fillBg:"#fff"},e=t.extend({},a,e),n={w:this.previewSize.w,h:this.previewSize.h},this.options.fitHeight&&!this.options.fitWidth&&this.imageSize.w*this.zoom<this.previewSize.w?n.w=this.imageSize.w*this.zoom:this.options.fitWidth&&!this.options.fitHeight&&this.imageSize.h*this.zoom<this.previewSize.h&&(n.h=this.imageSize.h*this.zoom),r=e.originalSize?1/this.zoom:this.options.exportZoom,i=t("<canvas />").attr({width:n.w*r,height:n.h*r}).get(0),o=i.getContext("2d"),"image/jpeg"===e.type&&(o.fillStyle=e.fillBg,o.fillRect(0,0,i.width,i.height)),o.drawImage(this.image,this.offset.x*r,this.offset.y*r,this.zoom*r*this.imageSize.w,this.zoom*r*this.imageSize.h),i.toDataURL(e.type,e.quality)):null},i.prototype.getImageState=function(){return{src:this.imageSrc,offset:this.offset,zoom:this.zoom}},i.prototype.getImageSrc=function(){return this.imageSrc},i.prototype.getOffset=function(){return this.offset},i.prototype.getZoom=function(){return this.zoom},i.prototype.getImageSize=function(){return this.imageSize?{width:this.imageSize.w,height:this.imageSize.h}:null},i.prototype.getPreviewSize=function(){return{width:this.previewSize.w,height:this.previewSize.h}},i.prototype.setPreviewSize=function(t){return(null!=t?t.width:void 0)>0&&(null!=t?t.height:void 0)>0?(this.previewSize={w:t.width,h:t.height},this.$preview.css({width:this.previewSize.w,height:this.previewSize.h}),this.options.imageBackground&&this.$imageBgContainer.css({width:this.previewSize.w+this.imageBgBorderWidthArray[1]+this.imageBgBorderWidthArray[3],height:this.previewSize.h+this.imageBgBorderWidthArray[0]+this.imageBgBorderWidthArray[2]}),this.imageLoaded?this.setupZoomer():void 0):void 0},i.prototype.disable=function(){return this.unbindListeners(),this.disableZoomSlider(),this.$el.addClass("cropit-disabled")},i.prototype.reenable=function(){return this.bindListeners(),this.enableZoomSlider(),this.$el.removeClass("cropit-disabled")},i.prototype.round=function(t){return Math.round(1e5*t)/1e5},i.prototype.$=function(t){return this.$el?this.$el.find(t):null},i}();var o,n;o="cropit",n={init:function(e){return this.each(function(){var n;return t.data(this,o)?void 0:(n=new i(this,e),t.data(this,o,n))})},destroy:function(){return this.each(function(){return t.removeData(this,o)})},isZoomable:function(){var t;return t=this.first().data(o),null!=t?t.isZoomable():void 0},"export":function(t){var e;return e=this.first().data(o),null!=e?e.getCroppedImageData(t):void 0},imageState:function(){var t;return t=this.first().data(o),null!=t?t.getImageState():void 0},imageSrc:function(e){var i;return null!=e?this.each(function(){var i;return i=t.data(this,o),null!=i&&i.reset(),null!=i?i.loadImage(e):void 0}):(i=this.first().data(o),null!=i?i.getImageSrc():void 0)},offset:function(e){var i;return null!=e&&null!=e.x&&null!=e.y?this.each(function(){var i;return i=t.data(this,o),null!=i?i.setOffset(e):void 0}):(i=this.first().data(o),null!=i?i.getOffset():void 0)},zoom:function(e){var i;return null!=e?this.each(function(){var i;return i=t.data(this,o),null!=i?i.setZoom(e):void 0}):(i=this.first().data(o),null!=i?i.getZoom():void 0)},imageSize:function(){var t;return t=this.first().data(o),null!=t?t.getImageSize():void 0},previewSize:function(e){var i;return null!=e?this.each(function(){var i;return i=t.data(this,o),null!=i?i.setPreviewSize(e):void 0}):(i=this.first().data(o),null!=i?i.getPreviewSize():void 0)},disable:function(){return this.each(function(){var e;return e=t.data(this,o),e.disable()})},reenable:function(){return this.each(function(){var e;return e=t.data(this,o),e.reenable()})}},t.fn.cropit=function(t){return n[t]?n[t].apply(this,[].slice.call(arguments,1)):n.init.apply(this,arguments)}}(window.jQuery),$(function(){var t=2;$("#daySet").on("change",function(){t=parseInt($(this).val(),10),console.log(t),$("#day").val(t),$(".step").addClass("day-"+t)});var e=0;$(".step-button").on("click",function(i){i.preventDefault(),e=parseInt($(this).attr("data-step"),10),e+=1,$(".step").removeClass("step-active"),$(".step-"+e).addClass("step-active"),console.log(e),console.log(t),e===t&&($(".step-end").addClass("step-active"),$(".step-"+e+" .step-button").hide())}),$(".image-editor-1").cropit({}),$(".image-editor-1 .export").click(function(t){t.preventDefault();var e=$(".image-editor-1").cropit("export",{type:"image/jpeg"});$(".image-editor-1 .preview-image").html('<img src="'+e+'">'),console.log(e),$("#image1").val(e)}),$(".image-editor-2").cropit({}),$(".image-editor-2 .export").click(function(t){t.preventDefault();var e=$(".image-editor-2").cropit("export",{type:"image/jpeg"});$(".image-editor-2 .preview-image").html('<img src="'+e+'">'),console.log(e),$("#image2").val(e)}),$(".image-editor-3").cropit({}),$(".image-editor-3 .export").click(function(t){t.preventDefault();var e=$(".image-editor-3").cropit("export",{type:"image/jpeg"});$(".image-editor-3 .preview-image").html('<img src="'+e+'">'),console.log(e),$("#image3").val(e)}),$(".image-editor-4").cropit({}),$(".image-editor-4 .export").click(function(t){t.preventDefault();var e=$(".image-editor-4").cropit("export",{type:"image/jpeg"});$(".image-editor-4 .preview-image").html('<img src="'+e+'">'),console.log(e),$("#image4").val(e)}),$(".image-editor-5").cropit({}),$(".image-editor-5 .export").click(function(t){t.preventDefault();var e=$(".image-editor-5").cropit("export",{type:"image/jpeg"});$(".image-editor-5 .preview-image").html('<img src="'+e+'">'),console.log(e),$("#image5").val(e)})}),$(function(){$(".facebook-share").on("click",function(t){t.preventDefault();var e=$(this).data("url"),i="http://gsntransformationcentre.co.uk/progress/"+$(this).data("img");console.log(i),FB.ui({method:"feed",link:e,name:"Gold Standard Nutrition",caption:"I just updated my progress picture!",description:"Day 7 of my #GSN30DayChallenge a personalised meal plan eating healthy food to reach my goals. Only 23 days to go",picture:i},function(){})})});